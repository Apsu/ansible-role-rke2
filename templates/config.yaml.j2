
{% if rke2_ha_mode and active_server is defined %}
server: https://{{ rke2_api_ip }}:9345
{% endif %}
{% if rke2_ha_mode and (rke2_token is defined) %}
token: {{ rke2_token }}
{% endif %}
{% if ansible_fqdn in groups['masters'] %}
node-taint:
  - "CriticalAddonsOnly=true:NoExecute"
tls-san:
  - cluster.local
  - {{ rke2_api_ip }}
{% endif %}
{% if rke2_disable and ( inventory_hostname|string() in groups['masters'] ) %}
disable: {{ rke2_disable }}
{% endif %}
{% if rke2_kube_apiserver_args is defined and ansible_fqdn in groups['masters'] %}
kube-apiserver-arg: {{ rke2_kube_apiserver_args}}
{% endif %}
{% if ( k8s_node_label is defined ) %}
node-label: 
{% for label in k8s_node_label %}
  - {{ label }}
{% endfor %}
{% endif %}
snapshotter: {{ rke2_snapshooter }}
